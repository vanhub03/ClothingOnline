@model Product
@using Microsoft.AspNetCore.Http
@using Newtonsoft.Json
@inject IHttpContextAccessor HttpContextAccessor

@{
    var productRelated = (List<Product>)ViewBag.productRelate;
    var session = HttpContextAccessor.HttpContext.Session;
    string jsoncart = session.GetString("accountSession");
}


<head>
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>

<body class="container fluid mt-5">
    <div class="row">
        <div class="col-md-6 mb-4 mb-md-0">
            <div class="mdb-lightbox">
                <div class="row product-gallery mx-1">
                    <div class="col-12 mb-0">
                        <img class="a img-thumbnail mt-3" src="~/Images/@Model.Images.First().Imagelink" />
                    </div>
                    <div class="col-12">
                        <div class="row row-cols-xl-6 justify-content-center">
                            @{
                                foreach (var item in Model.Images)
                                {
                                    <div class="col mb-5 mt-3 view overlay rounded z-depth-1 gallery-item ">
                                        <img class="b img-thumbnail" src="~/Images/@item.Imagelink" alt="Alternate Text" />
                                    </div>
                                }
                            }
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-6">
            <h5>@Model.Productname</h5>
            <p>
                <span class="mr-1">
                    <strong>@Model.Price VND</strong>
                </span>
            </p>
            <p class="pt-1">
                @Model.Description
            </p>
            <p>
                Số hàng: @Model.Unitinstock
            </p>
            <hr />
            <div class="card-footer p-4 pt-0 border-top-0 bg-transparent">
                @if (jsoncart != null)
                {
                    <div class="text-center"><a class="btn btn-outline-dark mt-auto" href="/product/addtocart?productId=@Model.Productid">Add to cart</a></div>
                }
                else if (Model.Enable == false)
                {
                    <p>Sản phẩm này hiện đã hết hàng. Vui lòng quay lại sau.</p>
                }
                else
                {
                    <div class="text-center">Login to add to cart</div>
                }
            </div>
        </div>
    </div>

    <h2>San pham lien quan</h2>

    <div class="px-4 px-lg-5 mt-5 row gx-4 gx-lg-5 row-cols-xl-4 justify-content-center">
        @{
            foreach (var item in productRelated)
            {
                <div class="col mb-5">
                    <div class="card h-100">
                        <img class="card-img-top" src="~/Images/@item.Images.First().Imagelink" alt="loi" />
                        <div class="card-body p-4">
                            <div class="text-center">
                                <h5 class="fw-bolder">
                                    <a class="pro-title" href="/product/getproductdetail?id=@item.Productid">
                                        @item.Productname
                                    </a>
                                </h5>
                                <strong class="price">@item.Price VND</strong>
                            </div>
                        </div>
                    </div>
                </div>
            }
        }
    </div>
</body>

<style type="text/css">
    .a {
        border-radius: 4px;
        padding: 5px;
        height: 600px;
        width: 450px;
        display: block;
        margin-left:auto;
        margin-right:auto;
    }

    .b {
        border-radius: 4px;
        padding: 5px;
        height: 100px;
        width: 75px;
        display:block;
        margin-right:auto;
        margin-left:auto;
    }

    .card-img-top {
        border-radius: 4px;
        padding: 5px;
        height: 240px;
    }

    .pro-title {
        color: #5A5A5A;
        display: inline-block;
        margin-top: 20px;
        font-size: 16px;
    }
</style>